---
title: "Untitled"
author: "Evangeline Reynolds"
date: "9/23/2019"
output: html_document
---

Build this as you go on chalk board!
# Grammar lesson order:

0. [**The Declarative Mood**, declaring data, *ggplot(data = gapminder)*](#data)
1. [**The Interogative Mood**, aesthetic mapping, *aes(**color** = pop)*](#aes)
  - [**Modifiers I**, changing aes scales, *scale\_**color**\_viridis_d()*](#scales)
  - [**Modifiers II**, changing aes and plot labels, *labs(**color** = "continent")*](#labs)
  - [**Modifiers III**, changing the coordinate system, *coord\_polar()*](#coords)
1. [**Nouns**, geometric objects, *geom\_point()*](#geoms)
1. [**The Conditional Mood** aesthetics tied to specific "geoms"](#local)
  - data, *geom\_point(data = gapminder)*
  - mapped aesthetic, *geom\_point(aes(color = continent))*
  - unmapped aesthetics (**i.e. The Imperative Mood**), *geom_point(color = "blue")*
1. [**Interjections**, annotation, *annotate(geom = "point", ...)*](#annotation)
1. [**Punctuation**, small multiple plots,  *facet_wrap(~continent)*](#facets)
1. [**Greetings**, changing plot look and feel, *theme_minimal()*](#themes)
1. [**The Written Language**, saving plots, *ggsave(file = "plot.png", plot = g)*](#saving)


```{r libraries, eval = T, echo = T}
library(tidyverse)
library(gapminder)
```


# Code to prep data - send to students - this is not a focus

```{r prep_data, eval = T, echo = T}
gapminder %>% # data from package
  filter(year == 2002) -> # filtering
gapminder_2002 # saving subset object
gapminder_2002 %>% 
  filter(continent == "Europe") ->
gapminder_2002_europe  
gapminder %>% 
  filter(continent == "Europe") ->
gapminder_europe
gapminder %>% 
  select(country, continent) %>% 
  distinct() %>% 
  group_by(continent) %>% 
  summarise(country_count = n()) ->
continent_aggregate
```


```{r}
ggplot(data = gapminder_2002) +
  aes(x = gdpPercap) +
  aes(y = lifeExp) +
  geom_point() +
  aes(color = continent) +
  aes(shape = continent) +
  aes(size = gdpPercap) +
  aes(alpha = gdpPercap) + # this much is familiar #REVEAL
  scale_x_log10() +  #REVEAL
  scale_y_reverse(limits = c(100, 0)) +  #REVEAL
  scale_color_viridis_d() +  #REVEAL
  scale_shape_discrete(solid = F) +  #REVEAL
  scale_size_continuous(  
    breaks = c(100, 1000, 10000, 100000),
    limits = c(0, 100000)) + #REVEAL
  scale_alpha(range = c(.3, .8)) + #REVEAL
  labs(x = "GDP per cap") + #REVEAL
  labs(y = "Life Expectency") + #REVEAL
  labs(color = "Continent") + #REVEAL
  labs(shape = "Continent") + #REVEAL
  labs(size = "GDP per cap") + #REVEAL
  labs(alpha = "GDP per cap") + #REVEAL
  # Note: labs is also used to adjust *plot* labels
  labs(title = "GDP per Cap versus Life Expectancy\nin 2002") + #REVEAL
  labs(subtitle = "Data: Gapminder Data in R") + #REVEAL
  labs(caption = "Visualization: @EvaMaeRey") + #REVEAL
  labs(tag = "Plot 1") + #REVEAL +
  coord_equal() + # overriding default
  coord_fixed(ratio = 400) + # overriding equal
  coord_polar() + # overriding fixed
  coord_flip() # overriding polar
```



# Conditional mood:

```{r}
ggplot(data = gapminder_2002) +
  aes(x = gdpPercap) +
  aes(y = lifeExp) +
  geom_point() + 
  aes(xend = gdpPercap) + # required aes for segment
  aes(yend = 0) + # required aes for segment
  geom_segment(data = gapminder_2002_europe,
               aes(color = gdpPercap,
                 size = pop),
               alpha = .2) 
```

# mix and match? 

```{r}
ggplot(data = gapminder_2002) +
  aes(x = gdpPercap) +
  aes(y = lifeExp) +
  geom_point(color = "grey") + 
  geom_point(
    # local data
    data = gapminder_2002_europe,
    # local mapped aesthetics
    aes(color = pop),
    # local across-the-board aesthetics
    size = 5
    ) +
  scale_color_viridis_c()
```

```{r}
ggplot(data = gapminder_2002) +
  aes(x = gdpPercap) +
  aes(y = lifeExp) +
  geom_point() +
  annotate(geom = "point", 
             x = 10000,
             y = 60, 
           color = "red") +
  annotate(geom = "text",
           x = c(3000, 10000, 40000),
           y = 80, 
           label = "Hello",
           color = "blue") +
  annotate(geom = "curve",
           x = 3000,
           y = 80, 
           xend = 10000,
           yend = 60,
           color = "green",
           arrow = arrow())
```

```{r annotation_geoms, eval = F, echo = F}
ggplot(data = gapminder_2002) +
  aes(x = gdpPercap) +
  aes(y = lifeExp) +
  geom_point() +
  geom_abline(slope = .01, intercept = 0) +
  geom_hline(yintercept = 70, 
             linetype = "dotted") +
  geom_vline(xintercept = c(1000, 10000),
             linetype = "dashed")
```


```{r facets, eval = F, echo = F}
ggplot(data = gapminder_2002) +
  aes(x = gdpPercap / 1000) +
  aes(y = lifeExp) +
  geom_point() +
  facet_wrap(~ continent, ncol = 2) +
  aes(color = continent) +
  facet_null() + # overrides facet_wrap
  facet_grid(
    pop > 10000000 ~ continent
    ) # overrides facet_null
```

```{r themes, eval = F, echo= F}
ggplot(data = gapminder_2002) +
  aes(x = gdpPercap) +
  aes(y = lifeExp) +
  geom_point() +
  aes(color = continent) +
  theme_bw() +
  theme_light(base_size = 5, 
              base_family = "Times") + 
  theme_classic(base_size = 15,
                base_family = "Rockwell") +
  theme_dark() +
  theme_minimal() +
  ggdark::dark_theme_dark() +
  ggthemes::theme_excel()
```


```{r}
g <- ggplot(gapminder_2002) +
  aes(x = gdpPercap) +
  aes(y = lifeExp) +
  geom_point() 

ggsave(filename = "my_plot.png", 
       plot = g)
```