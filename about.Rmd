---
title: "a ggplot2 grammar guide"
author: "Gina Reynolds"
date: "February, 2020"
output: 
  html_document:
    theme: yeti
    highlight: monochrome
---


```{r, echo = F}
library(viztoc)

knitr::opts_chunk$set(echo = F, eval = T, message = F, warning = F, cache = T)
```



```{css}
.static {
  position:absolute;
  background: white;
}

.static:hover {
  opacity:0;
}
```

<!-- <a href="https://evamaerey.github.io/flipbooks/about" target="_blank"><img class="static" src="https://lh4.googleusercontent.com/-gZiu96oTuu4/Uag5oWLQHfI/AAAAAAAABSE/pl1W8n91hH0/w140-h165-no/Homer-Static.png"><img class="active" src="https://lh4.googleusercontent.com/i1RprwcvxhbN2TAMunNxS4RiNVT0DvlD9FNQCvPFuJ0=w140-h165-no"></a> -->

<!-- **Homer dips his toe into some Data Viz! Leaving him here just for Data Viz Spring 2020!** -->


These are my ideas about the *grammar* of ggplot2.  ggplot2 is based on the grammar of graphics.  But it has its *own* grammar too --- it is a *particular* implementation of the grammar of graphics --- and a lot of really helpful decisions are part of its grammar (like having set defaults for aesthetic scales, and scale and plot labels make it easier to build plots quickly).  If you are teaching ggplot2, you might think about teaching the grammar of ggplot2 *first* and then come back to the *grammar of graphics* --- because there will be more context for seeing how an implemenation relates to the larger philosophy.  There are a lot of great resources out there already teaching the grammar of graphics which are sources of inspiration for the *guide*.  

*Not into human language grammar?  Just ignor that first column!*

<!-- > ggplot2 is the "programmatic reflection of [the grammar of graphics] theory" - Thomas Lin Pederson -->

<!-- > mapped aesthetics are the "graphical properties of the geometries."  -->

<!-- > scales translate back and forth between values in variables and percievable properties.  -->

<!-- > "geometries are pretty much all you think about all the time" - no -->

<!-- > "basic geometries"  boxplot - rectangle and some lines... -->

<!-- > "globular..." -->

<!-- > "color profile"  in printing... -->

<!-- > theme doesn't flow from the data itself...  "aesthetically pleaseing plots are more readable and likeable, but doesn't relate to the data" -->


<!-- > "legends guides axes are instrumental to understanding the plot - how can I interpret these graphical properties" -->

<!-- Of course it's interesting to teach the grammar of graphics along with ggplot2 --- ggplot2 is an implementation of the grammar of graphics.  But ggplot2 has its own grammar, so if you are teaching that tool, might as well teach that specific grammar.  --> 

<!-- > guides... -->

<!-- > setting aesthetics, vs mapping aesthetics... -->




Grammar Analogy | How?  | What? |
---|---|---|---
1. **The Declarative Mood**  | ggplot(data = gapminder) +| [Declaring the **data**](data_aes_geom.html){target="_blank"}
2. **The Interogative Mood** |aes(**color** = pop) + | [Asking for **representation of variables by aesthetics** (color, size, x position, etc.) (also known as **aesthetic mapping**) ](data_aes_geom.html#aes){target="_blank"} | `r viztoc:::build_and_use_gif(dir = "data_aes_geom_files/figure-html/", pattern = "area", href = "data_aes_geom.html", width = 150, height = 150, cached_gif = T, which = 8)`
    - *Modifiers I* | *labs(**color** = continent) +<br>labs(title = "my title") +* | [modifying *default* **aesthetic labels** (and **plot labels**)](modifiers.html#labs){target="_blank"} | `r viztoc:::build_and_use_gif(dir = "modifiers_files/figure-html/", pattern = "labs", href = "modifiers.html#labs", which = 11, width = 150, height = 150, cached_gif = T)`
    - *Modifiers II* | coord_polar() + | [modifying the *default* **coordinate system** (how the *positional* aesthetics appear - x and y)](modifiers.html#coords){target="_blank"}  | `r viztoc:::build_and_use_gif(dir = "modifiers_files/figure-html/", pattern = "coords", href = "modifiers.html#coords", which = 7, width = 150, height = 150, cached_gif = T)`
    - *Modifiers III* | *scale\_**color**\_viridis_d() +* | [modifying *default* **aesthetic scales**](modifiers.html#scales){target="_blank"} | `r viztoc:::build_and_use_gif(dir = "scales_files/figure-html/", pattern = "", href = "scales.html", which = 54, width = 150, height = 150, cached_gif = T)`
3. **Nouns** | *geom\_point() +* | [**geometric layers** taking on the aesthetics representing variables](data_aes_geom.html){target="_blank"} 
4.**The Conditional Mood**|*geom\_point(* | [Making **local**, **geom-specific** declarations rather than **global** declarations](local.html){target="_blank"} 
| | *data = gapminder,* | **data** is <br> geom-specific | `r viztoc:::build_and_use_gif(dir = "local_files/figure-html/", pattern = "data", href = "local.html", width = 150, height = 150, cached_gif = T)`
  | |  *aes(**size** = population),* |  **aesthetic representation**<br> is geom-specific | `r viztoc:::build_and_use_gif(dir = "local_files/figure-html/", pattern = "aes_mapping", href = "local.html", width = 150, height = 150, cached_gif = T)`
||   ***color** = "blue"<br>*  | **aesthetics *not* representing variables; *unmapped* aesthetics** (i.e.  **The Imperative Mood)** | `r viztoc:::build_and_use_gif(dir = "local_files/figure-html/", pattern = "unmapped", href = "local.html", width = 150, height = 150, cached_gif = F, which = 9)`
|| ) + |
5. **Interjections**| *annotate(geom = "point", <br> x = 10, <br> y = 12, <br> color = "blue")* | [Adding context with **annotation layers**](annotate.html){target="_blank"} | `r viztoc:::build_and_use_gif(dir = "annotate_files/figure-html/", pattern = "", href = "annotate.html", which = 7, width = 150, height = 150, cached_gif = F)`
6. **Punctuation**  | *facet_wrap(~continent)*| [**faceting** breaks a plot into small plots (or *"small multiples"*) based on categorical variables ](facet.html){target="_blank"} | `r viztoc:::build_and_use_gif(dir = "facet_files/figure-html/", pattern = "", href = "facet.html", which = 6, width = 150, height = 150, cached_gif = T)`
7. **Greetings**|*theme_minimal()* | [**themes** changing plot look and feel](themes.html){target="_blank"} | `r viztoc:::build_and_use_gif(dir = "themes_files/figure-html/", pattern = "", href = "themes.html", which = 48, width = 150, height = 150, cached_gif = T)`
8. **The Written Language** | *ggsave(file = "plot.png", <br> plot = g, <br>  height = "4in", <br> width = "6in")*|[save plots with different **resolutions** and **file formats**](ggsave.html){target="_blank"}
9. **Composition** | *library(patchwork) <br> (g1 + g2) \| g3 <br> <br> library(cowplot) <br> plotgrid(...,)* | [Composing plots into ensembles](ensembles.html){target="_blank"} | `r viztoc:::build_and_use_gif(dir = "ensembles_files/figure-html/", pattern = "", href = "ensembles.html", which = 32, width = 150, height = 150, cached_gif = T)`
10. **Concision** | last_plot(), switch out data with `%+%`, writing functions | [We've been intentionally verbose, but there are strategies for being concise](concision.html){target="_blank"}
---

```{r}
library(viztoc)
```



<!-- - *Modifiers IV* | guides() + | [to be added?] -->

### A closer look at geoms.

Above, the geom topics are intentionally cursory.  There are tons of geoms, and they can get distracting. But geoms are pretty fun - and there are a lot! 

```{r}
p <- "geoms_files/figure-html/"
```




<!-- r viztoc:::build_and_use_gif(path = "scales_files/figure-html/", pattern = ".")` -->



<div id="needtowrap">

```{r}
library(viztoc)
# viztoc:::build_and_use_gif()
# special_viztoc <- function(){
#   
#   build_and_use_gif()
#   
# }

```



`r viztoc:::build_and_use_gif(dir = "geoms_continuous_distribution_files/figure-html/", pattern = "", href = "geoms_continuous_distribution.html", width = 150, height = 150, cached_gif = T)`

`r viztoc:::build_and_use_gif(dir = "geoms_bivariate_continuous_files/figure-html/", pattern = "", href = "geoms_bivariate_continuous.html", which = 12, width = 150, height = 150, cached_gif = T)`


`r viztoc:::build_and_use_gif(dir = "geoms_single_series_files/figure-html/", pattern = "" , href = "geoms_single_series.html", width = 150, height = 150 , which = 8, cached_gif = T)`

`r viztoc:::build_and_use_gif(dir = "geoms_multi_series_files/figure-html/", pattern = "" , href = "geoms_multi_series.html", width = 150, height = 150 , cached_gif = T)`

`r viztoc:::build_and_use_gif(dir = "geoms_discrete_discrete_files/figure-html/", pattern = "" , href = "geoms_discrete_discrete.html" , width = 150, height = 150, cached_gif = T)`


  
  
</div>

  
```{css, echo = F}
#needtowrap {
  -webkit-columns: 5;
  -moz-columns: 5;
  columns: 5;
}
#needtowrap p {
  margin: 0;
}
#needtowrap p + p {
  text-indent: 1em;
}

```
  

```{r, out.width="12%", echo= F}
# build_and_use_gif(path = "geoms_files/figure-html/", 
#           pattern = "ref_lines")
```       
    

---

A Closer Look at Color

- [color theory](color.html){target="_blank"}
- [named colors in R](named_colors.html){target="_blank"}
- [paletteer's](paletteer.html){target="_blank"} large collection of palettes

`r viztoc:::build_and_use_gif(dir = "paletteer_files/figure-html/", pattern = "", href = "paletteer.html", which = 32, width = 250, height = 250, cached_gif = T)`

A Closer Look at Text

- [{ggtext} allows variation in color, font type, etc within text](https://evamaerey.github.io/flipbooks/ggtext/ggtext){target="_blank"}



r viztoc:::build_and_use_gif(dir = "ggtext_files/figure-html/", pattern = "" , href = "ggtext.html" )`

External Theme Packages

- [{ggeasy} easy adjustment for common theme modifications](themes_ggeasy.html){target="_blank"}
- [External Themes, {ggthemes} {ggthemr}](external_themes.html){target="_blank"}

Spatial with [geom_sf](geom_sf.html){target="_blank"} and [tmap](tmap.html){target="_blank"}

<div id="needtowrap">



`r viztoc:::build_and_use_gif(dir = "tmap_files/figure-html/", pattern = "" , href = "tmap.html" , width = 150, height = 150, cached_gif = T, which = 45)`

`r viztoc:::build_and_use_gif(dir = "geom_sf_files/figure-html/", pattern = "" , href = "geoms_sf.html", width = 150, height = 150, cached_gif = T, which = 80)`



</div>

<br>



---


Network visualization [{ggraph} and {tidygraph}](ggraph.html){target="_blank"} 

`r viztoc:::build_and_use_gif(dir = "ggraph_files/figure-html/", pattern = "" , href = "ggraph.html" , width = 250, height = 250, cached_gif = T, which = 10)`

---

Animation with [{gganimate}](gganimate.html){target="_blank"}


```{css, echo = F}
.button {
  background-color: #4682b4; /* Blue */
  border: none;
  color: white;
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
}
```




# Other guides to ggplot2

ggplot2 is very flexible, so there often there are more than one way of getting things done --- which also means there is more than one way to introduce ggplot2.
If you aren't on board with this guide (and even if you are)   you may want check out other resouces.  The more definitive and comprehensive guide to ggplot2 is the 3rd edition of [*ggplot2: elegant graphics for data analysis*](ggplot2-book.org){target="_blank"}. Some other workshop materials are Alison Hill's [Take a Sad Plot and Make it Better](https://alison.netlify.app/rlm-sad-plot-better/#1), Garrick Aden-Buie's [*A Gentle Guide to the Grammar of Graphics with ggplot2*](https://pkg.garrickadenbuie.com/gentle-ggplot2/#1){target="_blank"}, Will Chase's [*R you ready to make charts?*](https://www.williamrchase.com/slides/ggplot_intro.html#1){target="_blank"}, Malcom Barrett's [*Designing ggplots making clear figures that communicate*](https://designing-ggplots.netlify.com/#1){target="_blank"}, and Thomas Lin Pederson's [*Drawing anything with ggplot2*](https://github.com/thomasp85/ggplot2_workshop/blob/master/presentation.pdf){target="_blank"}.  [The ggplot2 cheatsheet](https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf){target="_blank"} is also excellent. 


<!-- --- -->

<!-- # Navigating the grammar guide -->

<!-- <a href="navigate.html" class="button">Suggested Navigation</a> -->

---


# Other Chapters



```{css, echo = F}
.button {
  background-color: #4682b4; /* Blue */
  border: none;
  color: white;
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
}
```

<a href="https://evamaerey.github.io/data_manipulation/about" class="button">Data Wrangling</a>
<a href="https://evamaerey.github.io/statistics/about" class="button">Statistical Analysis</a>




