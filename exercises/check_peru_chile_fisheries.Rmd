---
title: "Conflicts over resources:  the case of Chile and Peru"
author: "Evangeline Reynolds modifying Angela Zoss and Eric Monson's work"
output: html_document
---


```{r, echo = F}
knitr::opts_chunk$set(message = F, warning = F)
```

# Overview

In the following lab, you will answer some questions and create two new plots. 


# Background

In 1879–1883, Chile and Peru fought a war over resources.  What is the name of that war and what resource(s) were involved?  What other counrtry was involved? Not sure? You can search the web for this answer. 

> Answers here...

More recently a case was brought to the ICJ again over resources. *In a few sentences summarize the dispute.* Reference: https://www.icj-cij.org/en/case/137

> You answer here ... 


Now, check out the maps in the judgement:  https://www.icj-cij.org/files/case-related/137/137-20140127-JUD-01-00-EN.pdf
In these maps, the water is colored blue. *Now, what color is the land?*  

> Your answer here...

*How are the maps used to illuminate the dispute and ICJ's resolution of the dispute?  Which pages of the document contain these two maps?*

> Your answer here...

*Beyond fishing, name a one commodity for Chile's and one of Peru's of great importance for each state's economy.* You may search the web!


### The data and existing plots 

Fisheries and Aquaculture Department of the Food and Agriculture Organization of the United Nations collects data on fisheries production of countries. [This Wikipedia page](https://en.wikipedia.org/wiki/Fishing_industry_by_country) 
lists fishery production of countries for 2005. For each country tonnage from 
capture and aquaculture are listed. Note that countries which harvested less 
than 100,000 tons are not included in the data. 

Given below are existing data visualizations that violate many data visualization best practices. *Describe some what you think some problems w/ these might be here.*

> Your answer here...

![fisheries-plot](https://raw.githubusercontent.com/rstudio-education/datascience-box/master/assignments/hw-01/img/fisheries.png)

### Reading in the data

Your visualization will give important context to the ICJ case.  You will use the same data as used in the visualizations above, but will create better visualizations!  

### Install packages

What are the packages you need to install (in the console - not in the .Rmd!) to do this lab?  *Install them (in the console!).*

```{r load libraries}
library(tidyverse)
options(scipen = 10)  # scientific notation turns on later
```

### Importing data

The data cleaning has been done for you in the code below.  Check out the walk through here: https://evamaerey.github.io/little_flipbooks_library/data_cleaning/data_cleaning#26
Describe three or four data cleaning "moves" that you see done in this pipeline:

> your answer 


```{r data cleaning}
# using the htmltab package to scan html file
htmltab::htmltab(doc = "https://en.wikipedia.org/wiki/Fishing_industry_by_country",  
                 which = 2) ->  
fisheries_2015_raw

# code to read in the data and clean it is done for you here
fisheries_2015_raw %>%  
  as_tibble() %>%  # show data in "tidyverse" way, as_tibble
  janitor::clean_names(case = "snake") %>%  # snake is the default too
  mutate(capture =  
           readr::parse_number(x = capture)) %>%  
  mutate(aquaculture =  
           readr::parse_number(x = aquaculture)) %>%  
  mutate(total =  
           readr::parse_number(x = total)) %>%  
  mutate(country = str_trim(string = country)) %>%  
  mutate(region =  
           countrycode::countrycode(  
             sourcevar = country,  
             origin = "country.name",  
             dest = "region")) %>%  
  # country codes are useful for merging data
  mutate(iso3c =  
           countrycode::countrycode(  
             sourcevar = country,  
             origin = "country.name",  
             dest = "iso3c")) %>%  
  # one row is an aggregation - deleting this
  filter(country != "Total (2015)") %>% 
  mutate(country = str_replace(country, "Â", "")) %>%  # on PCs this step seems to be required because of how the data is read in. # won't cause problems for mac. 
  mutate(country = str_trim(country)) %>%  # this is another cleaning step that is needed for PCs, and won't cause problems for mac.
  mutate(peru_or_chile = country == "Chile" | country == "Peru") ->   
fisheries
```




### Data wrangling: creating a subset of fisheries

Now, in the next code chunk, create a subset of your data, containing only the Chile and Peru cases.  User `filter` on fisheries and create a new object called fisheries_peru_chile

```{r}
# starting with fisheries, wrangle to only the peru and chile cases, and create the object...
fisheries %>% 
  filter(country %in% c("Chile", "Peru")) ->
fisheries_peru_chile
```


### Create a scatter plot

- Create a scatter plot (geom_point) of capture v. aquaculture across all countries
- use color to represent the variable peru_or_chile
- Use the log10 scales for the x and y (scale_y_... )

- add a `geom_label()` layer and let the data for this layer be only `fisheries_peru_chile`.  You will need to add an `aes(label = ?)` statement to your ggplot.

- adjust labels for your *plot* as needed (title, subtitle, caption, x, y, color)


```{r}
# Your ggplot here
ggplot(data = fisheries) +
  aes(x = capture) +
  aes(y = aquaculture)
```



### Plot 2

Below you'll see code that creates a subset of the fisheries data only including the "Americas" (the variable continent is created for you below)

*Add a comment after each pipe explaining what has been done.*

```{r}
library(countrycode)  # you will need to install the package "countrycode"
fisheries %>% 
  mutate(continent = countrycode::countrycode(
    sourcevar = country, origin = "country.name", destination = "continent" ) ) %>% 
  filter(continent == "Americas") ->
fisheries_americas
  
```


- With `fisheries_americas`, create a column plot (`geom_col()`) where the capture for each country in the Americas is represented by a column.
- modifying the coordinate system, (coord_?) change the x axis to the y and vice versa. 
- set the fill color aesthetic to represent variable peru_and_chile variable,  aes(fill = ?)
- adjust labels for your *plot* as needed (title, subtitle, caption, x, y, color)

```{r}
# Make your plot here column plot

```


- Answer the question:  How else might you modify this plot to improve it?  (Your discussion doesn't need to be limited to your ggplot knowledge)

> Your answer here ...


## Getting help

You are also welcomed to discuss the homework with each other broadly 
(no copy, paste code sharing!).

## Grading

In addition to accuracy of your answers to questions, your submission will be 
evaluated for

- coding style,
- document organization, and
- quality of writing and grammar.

## More ugly charts

Want to see more ugly charts?

- [Flowing Data - Ugly Charts](https://flowingdata.com/category/visualization/ugly-visualization/)
- [Reddit - Data is ugly](https://www.reddit.com/r/dataisugly/)

## Acknowledgements

These exercises were originally created by [Angela Zoss](https://library.duke.edu/about/directory/staff/6881) 
and [Eric Monson](https://library.duke.edu/about/directory/staff/7561); they have been substantial reworked to have an IR focus by Evangeline Reynolds. 


